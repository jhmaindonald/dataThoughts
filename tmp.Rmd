---
title: "Untitled"
author: "John Maindonald"
date: "09/09/2021"
output: 
  bookdown::pdf_book
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tabulate by Admit and Gender
byGender <- margin.table(UCBAdmissions,
                         margin=c("Admit","Gender"))
admitRate <- round(100*prop.table(byGender, margin=2)["Admitted", ], 1)
```

Admission rates for males and females, by department, tell a different 
story from admission rates overall. 
Percentages are given,Â with totals who applied shown underneath.

```{r admitrates, comment=NA}
library(kableExtra)
UCB123 <- aperm(as.table(apply(UCBAdmissions,1:2, 
                function(x)c(x[1],x[2], CDEF=sum(x[3:6])))), c(2,3,1))
names(dimnames(UCB123))[3] <- "Dept"
byGender <- margin.table(UCB123,
                         margin=c("Admit","Gender"))
admitRate <- round(100*prop.table(byGender,
                   margin="Gender")["Admitted", ], 1)
admit <- cbind(TOTALS=admitRate, round(100*prop.table(UCB123,
                     margin=c("Gender","Dept"))["Admitted",,], 1))
tots <- cbind(apply(byGender,2,sum), 
              margin.table(UCB123, margin=c("Gender", "Dept")))
totals <- matrix(paste0('(',tots,')'),nrow=2)
admit <- rbind(admit, totals)[c(1,3,2,4),]
## tab <- xtable::xtable(admit, digits=1)
## print(tab, type='latex', comment=FALSE, floating=FALSE, scalebox=0.9)
x <- knitr::kable(admit)
x <- column_spec(x, 1:2, width = "4em", bold=TRUE)
column_spec(x, 3:5, width = "3em")
## print(admit, quote=F, right=T)
```

