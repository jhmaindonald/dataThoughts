# Fame that may spill over into notoriety

## [The MMR (measles, mumps, and rubella) scandal](
https://en.wikipedia.org/wiki/MMR_vaccine_controversy)

Andrew Wakefield was the lead author of a study published in 1998, 
based on just twelve children,  that claimed to find indications 
of a link between the MMR (measles, mumps, and rubella) vaccine 
and autism. The journalist Brian Deer had a key role in 
identifying issues with the work, including fraudulent 
manipulation of the medical evidence.

* Wakefield had multiple undeclared conflicts of interest
* Funding came from a group of lawyers who were interested
    in possible personal injury lawsuits
* It emerged that from 9 children said to have regressive autism   
    + Only 1 had been diagnosed; 3 had no autism  
    + 5 had developmental problems before the vaccine

Wakefield's 1998 claims were widely reported

* Vaccination rates in the UK and Ireland dropped sharply
* The incidence of measles and mumps increased, resulting
  in deaths and in severe and permanent injuries.
    
Wakefield was found guilty by the General Medical Council of serious professional misconduct in May 2010 and was struck off the Medical Register.     
Following the initial claims in 1998, multiple large epidemiological studies failed to find any link between MMR and autism.

Fact boxes on the Harding site summarize evidence of the 
effectiveness of the [MMR vaccine](https://www.hardingcenter.de/de/search/node?keys=mmr)^[https://www.hardingcenter.de/de/search/node?keys=mmr>]

## Sally Clark's disturbing cot death experience 

Sudden Infant Death (SID), also referred to as "cot death",
is the name given to the unexplained sudden death of very
young children.  The story of Sally Clark's unfortunate brush 
with the law, following the death of a second child, is
interesting, disturbing, and educational.  Sally's experience 
highlighted ways in which the UK legal system needed to take 
on board issues that affect the use of medical evidence ---
issues of a type that can be important in medical research.

Meadow argued that "unless proved otherwise, one cot death is tragic,
two is suspicious and three is murder." 
Was this an example of "Too hard! Try something easier, and wrong!"
Or was it the triumph of assumed "knowledge" over hard evidence?

Following the "cot death" of the second of Sally Clark's two children,
Meadow gave evidence at her trial in 1999, and appeal 
in 2000. Sally Clark was finally acquitted in 2003.

* Meadow gave 1 in 8,500 as cot death rate in affluent non-smoking families
    + Squared 8,500 to get odds of 73,000,000:1 against for two deaths.
    + Meadow assumed, wrongly, that the probability of a death from
    natural causes was the same in all families.
    + A first "cot death" is, in some families at least, evidence of a greater
    proneness to death from natural causes.
* Royal Statistical Society press release: "Figure has no statistical basis"
    + 2000 appeal judges: The figure was a
    "sideshow" that would not have influenced the jury's decision.
    + The appeal judges' statement was described by a leading QC, not
    involved in the case as: "a breathtakingly intellectually dishonest 
    judgment."
* 2003: It emerged that 2nd death was from bacterial infection  
    + In a second appeal, Sally Clark was freed.
* 2005: Meadow was struck from medical register
    + 2006: reinstated by appeal court --- misconduct fell short of "serious"!

Meadow was in effect assuming, without evidence, the
absence of family-specific genetic or social factors that
make cot deaths more likely in some families than in others. 
Why was Meadow's assumption of independence not challenged 
in the 1999 trial? Issues of whether or not different pieces 
of evidence are independent are surely crucial to assessing
the total weight of evidence.  Meadow had only enough 
understanding of probability to be dangerous. 

Sally Clark was finally acquitted on her second appeal in
2003, with her sense of well-being damaged beyond repair.
The forensic evidence had been weak.  The web page
  \url{https://plus.maths.org/content/os/issue21/features/clark/index}
  has a helpful summary of the statistical issues.  It
  quotes a study that suggests that the probability of a
  second cot death in the same family is somewhere between 1
  in 60 and 1 in 130.  Even after this adjustment, the
probability of death from natural causes of two children in
the same family is low.  But so also is the probability that
an apparently caring mother from an affluent middle class
family, with no history of abuse, will murder two of her own
children. Those are the two probabilities that must be
compared.  Anyone who plans to work as a criminal lawyer
ought to understand this crucial point.  In a
large population, there will from time to time be two deaths
from natural causes in the one family.

## John Snow documents a natural experiment

### The history that led up o the 1854 "experiment". {-}

* 6,500 died from cholera in London in 1832
     + Medical opinion blamed "miasma", or noxious air  
     (Stink from rotting garbage, faeces, & pollution in Thames)
     + Poor areas had more cholera -- worst smell, sanitation  
     (But, also, people were older, houses poorly heated, ...)
* Cesspits -- night-soil periodically taken away
* 1842:[Edwin Chadwick, in The Sanitary Conditions of the Labouring Population (1842)](https://www.sciencemuseum.org.uk/objects-and-stories/medicine/cholera-victorian-london)^[<https://www.sciencemuseum.org.uk/objects-and-stories/medicine/cholera-victorian-london>]
showed a direct link between poor living conditions, disease and life expectancy
     + Like others who accepted the "miasma" theory of disease, Chadwick did 
      not understand that cholera, along with some other major diseases, were water-borne.
* 1848: the Nuisances Removal and Diseases Prevention Act (Gazette issue 20637) was passed with the aim of stopping the 1848-9 epidemic.  The suggestion was to
effectively dump the contents of cesspools and raw 
sewage pits into the Thames, which was London's main source of drinking water. This only served to exacerbate the problem.
* 1848-49 epidemic followed shortly after the cesspits were banned
     + Both water companies --- Lambeth, and Southwark and Vauxhall, 
     were taking water from the same polluted source.
     + Death rates were high for both companies
* 1850: Arthur Hassall's careful microbiological study:
     + "... a portion of the inhabitants are made to consume  
     ... a portion of their own excrement, and ... to pay  
     for the privilege" [@hassall1850memoir]
     
See [Cholera epidemics in Victorian London](https://www.thegazette.co.uk/all-notices/content/100519)^[<https://www.thegazette.co.uk/all-notices/content/100519>]


### The 1854 epidemic --- a natural experiment {-}

The 1852 act required water supply companies to move water intake 
upriver by 1855.  By the time of the 1854 epidemic, Lambeth had 
moved the intake 22 miles upriver, where the water was not
contaminated by London sewage.  The Southwark and Vauxhall intake 
was unchanged until 1855.  Data on the distribution of cholera in 
the 1854 epidemic then allowed Snow to test the claims made in his 
1849 study.

"The experiment, too, was on the grandest scale. No fewer than 300,000 people ..., from gentlefolks down to the very poor, were divided into two groups without their choice, and, in most cases, without their knowledge; one group being supplied with water containing the sewage of London, and, amongst it, whatever might have come from the cholera patients, the other group having water quite free from such impurity."

### Lambeth versus Southwark & Vauxhall {-}

```{r DeathTable, results="asis"}
tab <- cbind("#Houses"=c(40046,26107,256423),
             "#Deaths"=c(1263,98,1422),
             "Rate per 10,000"=c(315,37,59))
dimnames(tab)[[1]] <- c("Southwark & Vauxhall","Lambeth","Rest of London")
print(xtable::xtable(tab, auto=TRUE),type='latex', comment=FALSE, floating=FALSE, scalebox=1.12)
```

### Use water from the brewery, and stay healthy! {-}

Snow noted that “Within 250 yards of the spot where Cambridge Street joins Broad 
Street there were upwards of 500 fatal attacks of cholera in 10 days…”.
By contrast, none of the employees of a local Soho brewery developed cholera.

The reason, he judged, was that they drank water from the brewery (which had a 
different source from the Broad St pump) or just drank beer alone.  
@coleman2019causality gives detailed comments on Snow's work.
It took a further ten years for the medical establishment to begin to accept
Snow's conclusions.

```{r cap2, echo=FALSE}
cap2 <- "Deaths (red dots) and pump locations.  Polygons that surround
each pump enclose the locations for which that is the nearest pump."
```

```{r pump, fig.show="hold", out.width="60%", fig.pos="H", fig.cap=cap2}
library(HistData)
SnowMap(polygons=TRUE, main="Snow's Cholera Map with Pump Polygons")
```

Similar issues, arising from failures to ensure proper drainage systems,
were repeated, from the 1840s and 1850s through until the end of the century,
in New Zealand cities. See  
[Christine Dann, Sewage, water and waste - Stinking cities', Te Ara - the Encyclopedia of New Zealand, (8 June 2017)](https://teara.govt.nz/en/zoomify/24431/dunedin-renamed-stinkapool)^[<https://teara.govt.nz/en/zoomify/24431/dunedin-renamed-stinkapool>]


## The Reinhoff and Rogoff saga (Smith, p.55)

Figure \@ref(fig:debt2gdp12) plots data that underpinned
the 2010 paper "_Growth in Time of Debt_" by the two Harvard economic 
historians Reinhart and Rogoff [RR].  The paper [@reinhart2010growth]
has been widely quoted in support of economic austerity programs
internationally.  There was a huge stir, in the media and on the
blogosphere, when graduate student Herndon found and published 
details of coding and other errors in the results that RR had
presented.

```{r cap1and2, echo=FALSE}
cap3 <- "Red lines show means by Debt/GDP category.
The means for > 90\\% Debt/GDP were from data for 10 only of the
20 countries.  The red dotted line shows the (incorrect) 
mean given by RR.  The smooth curve, fitted treating points
as independent, shows no sudden change.  It makes better sense
to allow each country its own separate curve."
```

```{r GG-mgcv, echo=FALSE}
library(ggplot2, quietly=TRUE)
library(mgcv, quietly=TRUE)
```

```{r debt2gdp12, echo=FALSE, fig.width=7, fig.height=4.75, warning=FALSE, message=FALSE, out.width="100%", fig.align="center", fig.show="hold", fig.pos='H',fig.cap=cap3, cache=TRUE}
load('data/RR.RData')
RR.gam <- gam(dRGDP ~ s(debtgdp, bs="cs"),data=RR)
res <- residuals(RR.gam)
avTO30 <- mean(subset(RR, debtgdp<=30)[ ,'dRGDP'])
av30TO60 <- mean(subset(RR, debtgdp>30 & debtgdp<=60)[ ,'dRGDP'])
av60TO90 <- mean(subset(RR, debtgdp>60 & debtgdp<=90)[ ,'dRGDP'])
av4 <- sapply(split(RR,RR$Country), function(x)
  c(avTO30 = mean(subset(x, debtgdp<=90)[ ,'dRGDP']),
  av30TO60 = mean(subset(x, debtgdp>30 & debtgdp<=60)[ ,'dRGDP']),
  av60TO90 = mean(subset(x, debtgdp>60 & debtgdp<=90)[ ,'dRGDP']),
  av90plus = mean(subset(x, debtgdp>90)[ ,'dRGDP']),
  n90plus = nrow(subset(x, debtgdp>90))))
av4n <- av4[,!is.nan(av4[4,])]
av90plus <- sum(av4n[4,]*av4n[5,])/sum(av4[5,])
m <- ggplot(RR, aes(x=debtgdp,y=dRGDP), environment=environment())
m <- m + geom_vline(xintercept=90,color='lightgray',size=1.5)
m <- m + geom_point(color='darkgray', size=1.5) + ylab("Real GDP Growth") + 
  xlab("Public Debt/GDP Ratio") + 
  scale_x_continuous(breaks=seq(0,240,30)) + theme_bw()
m <- m + geom_segment(aes(x = 0, y = avTO30, xend = 30, yend = avTO30), 
                      linetype="solid", size=0.5, alpha=0.25, color="sienna") + 
  geom_segment(aes(x = 30, y = av30TO60, xend = 60, yend = av30TO60), 
               linetype="solid", size=0.5, alpha=0.25, color="sienna") + 
  geom_segment(aes(x = 60, y = av60TO90, xend = 90, yend = av60TO90), 
               linetype="solid", size=0.5, alpha=0.25, color="sienna") + 
  geom_segment(aes(x = 90, y = 2.2, xend = 245, yend = 2.2), 
               linetype="solid", size=0.5, alpha=0.25, color="sienna") + 
  geom_segment(aes(x = 90, y = -0.1, xend = 245, yend = -0.1), 
               linetype="dashed", size=0.25, alpha=0.25, color="sienna")
keep <- (res > 11.15)|(res < -10.15) | (RR[,'debtgdp'] > 210) |
  (RR[,'debtgdp'] > 90 & abs(res)>5) | (RR[,'debtgdp'] > 180 & res<0)
RRkeep <- RR[keep,]
hj <- rep(-0.085, sum(keep))
onleft <- with(RRkeep,(debtgdp < 90)|
                 (debtgdp > 220))
hj[onleft] <- 1.075
txlab <- with(RRkeep, paste(iso2c, Year))
m <- m + geom_smooth(method=gam, color=adjustcolor('black',alpha=0.4),
                     formula= y ~ s(x, bs = "cs"),lwd=2)
m1 <- m + geom_text(data = RRkeep, aes(x=debtgdp,y=dRGDP, label = txlab), 
                    size=3, hjust = hj)+xlab("Ratio of debt to GDP (%)")+
                    ylab("GDP growth (%)") + 
                    ggtitle("GDP growth versus Debt/GDP")

tagged <- as.character(unique(RRkeep$Country))
tag2 <- RRkeep[match(tagged, RRkeep[, 'Country']), 'iso2c']
tag2 <- as.character(tag2)
leg <- cbind(tag2, tagged)[tag2!=tagged,]
dimnames(leg)[[2]] <- NULL
library(gridExtra)
tt <- ttheme_default(base_size=9)
print(m1+annotation_custom(tableGrob(leg, theme=tt),
                           xmin=210, xmax=250, 
                           ymin=10.0, ymax=28))

# library(mgcv)
# load('data/RR.RData')
# RR.gam <- gam(dRGDP ~ s(debtgdp, bs="cs"),data=RR)
# res <- residuals(RR.gam)
# m <- ggplot(RR, aes(x=debtgdp,y=dRGDP))
# m <- m + geom_vline(xintercept=90,color='lightgray',size=1.5)
# m <- m + geom_point(color='darkgray', size=1.5) + ylab("Real GDP Growth") + xlab("Public Debt/GDP Ratio") + scale_x_continuous(breaks=seq(0,240,30)) + theme_bw()
# m <- m + geom_smooth(method=gam, color='black',formula= y ~ s(x, bs = "cs"))
# m <- m + geom_segment(aes(x = 90, y = 2.2, xend = 245, yend = 2.2), linetype="dashed", size=0.25, alpha=0.25, color="sienna") + geom_segment(aes(x = 90, y = -0.1, xend = 245, yend = -0.1), linetype="dashed", size=0.25, alpha=0.25, color="sienna")
# keep <- (res>0 & abs(res)>11.15)|(res<0 & abs(res)>10.15) |
#   (RR[,'debtgdp'] > 180 & res<0)
# RRkeep <- RR[keep,]
# hj <- rep(-0.085, sum(keep))
# onleft <- with(RRkeep,(Country %in% c("NZ","Ireland"))|
#                  (debtgdp > 180))
# hj[onleft] <- 1.075
# txlab <- with(RRkeep, paste(iso2c, Year))
# m1 <- m + geom_text(data = RRkeep, aes(x=debtgdp,y=dRGDP, label = txlab), size=3, hjust = hj)+ggtitle("B: As Panel A, with an indicative smooth curve")
# tagged <- as.character(unique(RRkeep$Country))
# tag2 <- RRkeep[match(tagged, RRkeep[, 'Country']), 'iso2c']
# tag2 <- as.character(tag2)
# leg <- cbind(tag2, tagged)[tag2!=tagged,]
# dimnames(leg)[[2]] <- NULL
# library(gridExtra)
# tt <- ttheme_default(base_size=9)
# print(m1+annotation_custom(tableGrob(leg, theme=tt),
#                            xmin=210, xmax=250, 
#                            ymin=11.0, ymax=26))
```

As well as coding errors, 
[Herndon](http://www.peri.umass.edu/fileadmin/pdf/working_papers/working_papers_301-350/WP322.pdf)^[<http://www.peri.umass.edu/fileadmin/pdf/working_papers/working_papers_301-350/WP322.pdf>] identified selective exclusion of available data, 
and unconventional weighting of summary statistics.  There was a 
failure to acknowledge that the relationship studied has varied 
substantially by country and over time.  

In response to @herndon2014does and other critics, Reinhart and 
Rogoff accepted that coding errors had led to the omission of 
several countries, but pushed back against other criticisms. 
Their revised analysis addresses only the most egregious errors 
in their work.  Among other issues, their insistence on treating 
each data point for each country as an independent piece of 
evidence makes no sense.

The smooth curve seems as good a summary as any, if 
points are, wrongly, to be treated as disconnected from country.

```{r cap3, echo=FALSE}
cap3 <- "Smooths have been fitted for each of the 10 countries
for which debt to GDP ratios were in some years greater than 90\\%.
There is no consistent pattern, as there should be if RR's claim
is to hold up."
```

```{r debt2gdp-3, echo=FALSE, fig.width=7.0, fig.height=3.5, warning=FALSE, error=FALSE, fig.pos="H", fig.cap=cap3}
  if(!require(lattice, quietly=TRUE))stop("Lattice package must be available.")
RR10 <- droplevels(subset(RR, Country%in%colnames(av4n)))
fit.gam <- gam(dRGDP~s(debtgdp, bs='cr', k=4, by=Country), data=RR10)
hat <- fitted(fit.gam)
  xyplot(hat~debtgdp, groups=Country, data=RR10, type="l", ylim=c(-3.5,8),
 xlab="Ratio of debt to GDP (%)", ylab="GDP growth (%)", out.width='80%',
 panel=function(x,y,groups,subscripts,...){
 panel.superpose(x, y, ..., 
 panel.groups=function(x,y,...){
 ord <- order(x)
 xord <- x[ord]
 yord <- y[ord]
 panel.lines(xord,yord, ...)
 im <- which.max(xord)
 xm <- min(xord[im],240)
 ym <- yord[im]
 gp <- list(...)$group.value
 if(gp%in%c("Canada"))ym <- ym-0.1
 if(gp%in%c("Belgium"))ym <- ym+0.1
 if(gp%in%c("Ireland"))ym <- ym-0.05
 if(xm>90)
 panel.text(xm,ym,labels=gp, pos=4, offset=0.25)
 }, groups=groups, subscripts=subscripts)})
```

### Is there a pattern across countries? {-}

```{r av4}
av4 <- sapply(split(RR,RR$Country), function(x)
c(avTO30 = mean(subset(x, debtgdp<=90)[ ,'dRGDP']),
av30TO60 = mean(subset(x, debtgdp>30 & debtgdp<=60)[ ,'dRGDP']),
av60TO90 = mean(subset(x, debtgdp>60 & debtgdp<=90)[ ,'dRGDP']),
av90plus = mean(subset(x, debtgdp>90)[ ,'dRGDP']),
nyears = nrow(subset(x, debtgdp>90))))
av4n <- av4[,!is.nan(av4[4,])]
dRGDPav <- sum(av4n[4,]*av4n[5,])/sum(av4[5,])
```
There were just `r ncol(av4n)` countries where debt to GDP ratios were 
greater than 90% for one or more years.  For `r sum(av4n[4,]>0)` of 
those countries, the average of their GDP growth in the years at issue 
was on average positive relative to the previous year.  The average 
percentage growth over all `r ncol(av4n)` countries, weighted according 
to number of years, was `r round(dRGDPav, 3)`.

## There are further serious issues of interpretation {-}

* Does GDP drive debt/GDP ratio, or is it the other way round?
    + Or does a third factor drive both?
* Is the effect immediate, or on future economic performance

Smith (p.64) refers to work indicating that economic performance
is more closely correlated with economic growth in the past than
with future growth.

## Parting comments {-}

@herndon2014does comment

"... RR’s findings have served as an intellectual bulwark in support of austerity politics. The fact that RR’s findings are wrong should therefore lead us to reassess the austerity agenda itself in both Europe and the United States."  
  
The saga emphasizes the importance of working with reproducible code, 
rather than with spreadsheet calculations. 
The errors in RR's calculations were from one perspective fortunate.
Once highlighted, the errors drew critical attention to the paper, 
and to the serious flaws in the analysis.

<!-- ## The "pills may cause blood clots" saga -->

<!-- An October 1995 letter to doctors from the UK Committee -->
<!-- on the Safety of Medicines cited "new evidence" -->
<!-- indicating that:   -->
<!-- > . . . __the risk of thrombosis is increased by a factor of -->
<!-- two for some contraceptives relative to others__ . . .  -->
<!-- > but the pill is safe for most women . . . [Ellenberg, p.118] -->
<!-- Associated Press Report: http://bit.ly/2pQOxXQ -->

<!-- The change in risk was small.  The estimated risk increase was from 1 in 7000 -->
<!-- to 2 in 7000 -->

<!-- * 2 $\times$ 0.000014 = ?  (Risk of death was smaller still)     -->

<!-- A later analyses gave the risk as 1.7 in 7000, i.e., no increase, -->
<!-- irrespective of the contraceptive used.  There were other  -->
<!-- consequences that had not been adequately considered. -->
<!-- Comparing 1996 with 1995, there were 26,000 more births, and 13,600 -->
<!-- more abortions.  A large part of this increase was surely a result -->
<!-- of the "Dear Doctor" letter. -->
